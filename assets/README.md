# HTML离线工具使用说明

## 功能概述

法律文件脱敏处理工具的HTML离线版本，支持docx文件上传、智能识别脱敏、实时预览和导出功能。

## 使用方法

### 启动工具

双击 `index.html` 文件，在浏览器中打开。

### 操作流程

#### 1. 上传文件

- 点击上传区域选择docx文件
- 或直接拖拽文件到上传区域

#### 2. 自动识别

系统自动应用默认规则识别敏感信息：
- 公司名称
- 日期
- 价格/金额
- 文件编号
- 项目名称
- 联系方式
- 地址

#### 3. 预览编辑

**原文预览区**:
- 显示原始文档内容
- 已识别的脱敏项用黄色高亮显示
- 点击高亮文本可查看/编辑脱敏项

**脱敏项列表**:
- 查看所有脱敏项
- 点击删除按钮移除误识别项
- 双击替换文本进行修改
- 点击类型标签修改分类

**脱敏预览区**:
- 实时显示脱敏后效果
- 黄色高亮显示脱敏内容

#### 4. 手动添加脱敏项

1. 在原文预览区选中要脱敏的文本
2. 点击"添加脱敏"按钮
3. 选择脱敏类型
4. 确认添加

**快速添加功能**：在原文预览区选中文本后，会自动弹出添加窗口，无需手动点击按钮。

#### 5. 白名单/黑名单管理

点击"📋 白名单/黑名单"按钮打开管理界面：

**白名单（不脱敏）**：
- 左侧区域显示白名单项
- 输入内容后点击"添加"按钮
- 点击列表项可删除
- 白名单中的内容不会被脱敏

**黑名单（强制脱敏）**：
- 右侧区域显示黑名单项
- 输入内容后点击"添加"按钮
- 点击列表项可删除
- 黑名单中的内容强制脱敏为【敏感信息】

**优先级规则**：白名单 > 黑名单 > 默认规则

#### 6. 调试模式

勾选"🐛 启用调试模式"复选框后：

- 调试面板显示在操作栏下方
- 实时显示脱敏处理日志
- 可导出日志为txt文件

**查看浏览器控制台**：
- 按F12打开开发者工具
- 切换到Console标签
- 查看详细调试信息

#### 7. 导出结果

点击"导出"按钮，可选择导出：

- **脱敏文件.docx**: 保留原格式的脱敏文档（简单文本替换）
- **脱敏规则JSON**: 用于Python脚本生成脱敏docx
- **替换比对.md**: 用于还原脱敏内容
- **脱敏预览.md**: 快速分享查看

## 界面说明

### 主界面布局

```
+----------------------------------+
|       文件上传区域               |
+----------------------------------+
|  原文预览  | 脱敏项 | 脱敏预览 |
|            |  列表  |         |
|            |       |         |
+----------------------------------+
|     导出按钮                    |
+----------------------------------+
```

### 高亮样式

- **黄色背景**: 已识别的脱敏内容
- **鼠标悬停**: 显示脱敏详情
- **点击选中**: 进入编辑状态

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+Z | 撤销上一步操作 |
| Ctrl+Y | 恢复操作 |
| Ctrl+S | 保存当前状态 |
| Delete | 删除选中的脱敏项 |

## 技术特点

- **完全离线**: 无需网络连接
- **浏览器处理**: 所有操作在本地完成
- **格式保留**: 保留原文段落结构
- **实时预览**: 即时显示脱敏效果

## 浏览器兼容性

- Chrome 90+
- Edge 90+
- Firefox 88+
- Safari 14+

## 常见问题

### Q: 上传后没有反应？

A: 检查文件格式是否为.docx，文件大小是否超过限制。

### Q: 识别结果不准确？

A: 可以手动添加或删除脱敏项，导出规则供后续使用。

### Q: 如何保留原格式生成docx？

A: 导出规则JSON后，使用Python脚本 `redact.py` 处理。

### Q: 导出的docx格式有变化？

A: 使用Python脚本可以更好地保留原格式。
