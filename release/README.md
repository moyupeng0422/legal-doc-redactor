# 法律文件脱敏处理工具 v1.3.0

## 快速开始

**双击 `index.html` 文件即可启动**

支持 Windows、Mac、Linux 系统

---

## ⚠️ Mac 用户注意

**请先解压再使用！**

1. 双击 `legal-doc-redactor-v1.3.0.zip` 进行解压
2. 打开解压后的 `legal-doc-redactor-v1.3.0` 文件夹
3. 双击 `index.html` 打开工具

**不要**直接从压缩包中双击打开 index.html，否则会无法加载必要的 JavaScript 文件，导致文件上传功能无法正常使用。

---

## 模式选择

打开工具后，请根据使用场景选择模式：

### 脱敏模式
将敏感信息替换为【X】标记，用于对外分享、保护隐私

### 还原模式
将脱敏稿还原为原文，用于外部/AI审核后恢复原文

---

## 脱敏模式使用说明

### 步骤 1：上传文件
将需要脱敏的 `.docx` 文件拖入窗口，或点击上传按钮选择文件

### 步骤 2：自动识别
工具会自动识别 15 类敏感信息，并用黄色高亮显示

### 步骤 3：编辑调整（双向联动）
**三栏预览界面：**
- **原文预览** - 显示原始文档，黄色高亮已识别内容
- **脱敏项列表** - 查看所有识别项，可删除误识别内容
- **脱敏预览** - 实时显示脱敏后的效果

**双向联动功能：**
- 点击原文预览的黄色高亮，脱敏项列表自动滚动到对应项
- 点击脱敏项列表中的项，原文预览自动滚动到对应位置

### 步骤 4：自定义脱敏（自动弹出）
在原文预览区选中文本后，会**自动弹出**自定义脱敏窗口：
- 选择脱敏类型（如人名、日期、金额等）
- 确认添加后，会询问"是否加入黑名单"

### 步骤 5：白名单/黑名单/自定义类型管理
- **白名单** - 添加后不会被脱敏（覆盖检查，如"计划"可排除"股权激励计划"）
- **黑名单** - 强制脱敏，优先级最高，不受白名单限制
- **自定义类型** - 创建新的脱敏类型（如"合同名称"），批量添加匹配内容

**优先级规则：** 黑名单（最高）> 白名单 > 脱敏类别（内置+自定义）

### 步骤 6：导出文件
- **脱敏文件.docx** - 保留原格式的脱敏文档
- **替换比对.md** - **务必保存**，用于后续还原
- **白名单.xlsx** - 导出白名单，方便分享和备份
- **敏感词库.xlsx** - 导出黑名单+自定义类型，方便分享和备份

**智能提示：**
- 删除脱敏项时，会检测来源，黑名单/自定义类型内容需手动删除后才能加入白名单

---

## 还原模式使用说明

### 步骤 1：切换到还原模式
点击顶部的"还原"标签页

### 步骤 2：上传文件
- 拖入脱敏后的文档（`.docx`）
- 拖入"比对词.md"文件（脱敏时生成）

### 步骤 3：执行还原
点击"执行还原"按钮，自动下载还原后的文档

**注意：** 还原时文档中的修订和批注会完整保留

---

## 调试功能

调试功能不是独立模式，而是可以在脱敏模式和还原模式下启用的功能开关。

### 脱敏模式下的调试
- **识别详情** - 显示识别到的每一处敏感信息及其位置
- **脱敏规则** - 显示应用的脱敏规则类型
- **白名单/黑名单匹配** - 显示哪些内容被白名单过滤或黑名单强制脱敏
- **处理时间戳** - 显示每一步的处理时间

### 还原模式下的调试
- **还原进度** - 显示还原操作的实时进度
- **替换日志** - 显示每个【X】标记被替换为原文的过程
- **错误信息** - 显示比对词不匹配、无法找到对应项等错误

---

## 支持的脱敏类型

| 类型 | 说明 | 示例 |
|------|------|------|
| 人名 | 个人姓名 | 张三 |
| 公司名称 | 企业名称 | XX科技有限公司 |
| 日期 | 日期时间 | 2024年1月1日 |
| 金额 | 价格/金额 | 10万元 |
| 电话 | 联系电话 | 13800138000 |
| 邮箱 | 联系邮箱 | example@email.com |
| 身份证号 | 身份证号码 | 110101199001011234 |
| 银行账号 | 银行账户号 | 6222XXXXXXXXXXXX |
| 信用代码 | 统一社会信用代码 | 91XXXXXXXXXXXXXXX |
| 案号 | 司法案件编号 | （2023）京01民初123号 |
| 专利申请号 | 专利申请编号 | CN202310XXXXXX |
| 文件编号 | 文件编号 | (2023)京01民初123号 |
| 项目名称 | 项目名称 | XX项目 |
| 地址 | 地址信息 | 北京市XX区XX路 |
| 组织机构码 | 组织机构代码 | XXXXXXXX-X |

---

## 导入敏感词库

支持从 Excel 文件批量导入敏感词，无需手动逐个添加。

### Excel 文件格式

| A列（敏感词） | B列（类型） |
|--------------|------------|
| 张三 | 人名 |
| ABC公司 | 组织机构 |
| 华为 | 商标名 |

### 导入规则

- **内置类型**（人名、组织机构、日期、金额、电话、邮箱、身份证号、银行账号、统一社会信用代码、组织机构代码、专利申请号、文件编号、案号、项目名称、地址、敏感信息）：导入到**黑名单**，使用该类型的替换模板
- **自定义类型**（如"商标名"、"客户名"等）：创建新的自定义脱敏类型

### 使用方法

1. 点击"📋 白名单/黑名单"按钮
2. 点击"📥 导入词库"按钮
3. 选择 Excel 文件
4. 预览导入内容，确认后点击"确认导入"

### 冲突处理

如果导入的敏感词已存在于白名单/黑名单/自定义类型中，可选择：
- **跳过冲突项**：保留现有内容，不导入冲突项
- **覆盖冲突项**：删除现有内容，导入新项

---

## 常见问题

**Q: 数据会上传到服务器吗？**
A: 不会。所有处理都在您的浏览器本地完成，完全离线。

**Q: 脱敏后的文档格式会乱吗？**
A: 不会。工具会保留原文的所有格式（字体、段落、表格等）。

**Q: 如何保存自定义规则？**
A: 在"白名单/黑名单"中添加的规则会自动保存到浏览器，下次打开工具时自动加载。

**Q: 支持 Mac/Linux 吗？**
A: 支持。所有系统（Windows/Mac/Linux）都是双击 `index.html` 即可使用。

**Q: 如果不小心删除了比对词.md文件怎么办？**
A: 比对词.md文件是还原的关键，无法重新生成。请务必妥善保存该文件。

**Q: 选中文本后没有自动弹出自定义窗口？**
A: 请确保在"原文预览"区域选中文本，而不是"脱敏预览"区域。自定义功能仅在原文预览区可用。

---

## 技术支持

- **许可证**: MIT License
- **完全离线**，数据不上传
